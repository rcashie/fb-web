UPSERT INTO `published` (KEY k, VALUE v)
SELECT RAW {
    "k": "tset::" || meta(`char`).id,
    "v": {
        "game": $id,
        "type": "tagset",
        "tags": ARRAY_CONCAT([char.title], char.tags),
        "parentTags": gameTagSet.tags
    }
}
FROM `published` AS char
JOIN `published` AS gameTagSet ON KEYS["tset::game::" || char.game]
WHERE
    char.type = "character"
    AND char.game = $id
